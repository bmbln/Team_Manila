---
title: "Report on Coke and Snickers price differences"
output: 
  pdf_document:
    extra_dependencies: ["float"]
---


```{r setup, include=FALSE}

rm(list = ls())

library(tidyverse)
library(modelsummary)
library(kableExtra)
library(ggplot2)

# Import data
df <- read.csv( url( "https://raw.githubusercontent.com/bmbln/Team_Manila/main/Coding1/assignment1/data/da1_datacollection.csv" ) , encoding = "UTF-8")

## Changing var types to binary ##
df$sunday_open <- ifelse(df$sunday_open == 'Yes', 1, 0)
df$chain_membership <- ifelse(df$chain_membership == 'Yes',1,0) 

## Inner/outer is a factor ##
df$city <- as.factor(df$city)

#we have no missing values nor duplicates, therefore no further cleaning is necessary. 

#Setting the ggplot theme
theme_custom <- function( base_size = 10, base_family = "") {
  theme_bw() %+replace% 
    theme(
      plot.background   = element_rect( fill = "grey92" , colour = "grey92" ) ,
      panel.grid.major  = element_line( color = "white" ),
      panel.background  = element_rect( fill = "grey92", colour = "grey92" ),
      panel.border      = element_rect( linetype = "solid" , fill = NA ), 
      axis.line         = element_line( color = "black" , size = 1 ),
      axis.ticks        = element_line( color = "red4" , size = 2 ),
      axis.text         = element_text( color = "black" , size = base_size*0.9 ),
      axis.ticks.length.y = unit( .25, "cm"),
      axis.ticks.length.x = unit( .25, "cm"),
      axis.title = element_text( size = base_size*0.9 ),
      legend.text = element_text( size = base_size*0.7 ),
      legend.title = element_text( size = base_size*0.8 ),
      legend.key.size = unit( .4, "cm"),
      legend.position = 'top',
      legend.justification= 'left',
      legend.direction= 'horizontal'
    )
}

```

## Introduction

This is a report on *Coke and Snickers price differences*. 

HERE COMES THE MOTIVATION WHY THIS IS A MEANINGFUL PROJECT AND WHAT IS THE MAIN GOAL!


## Data

HERE COMES A DETAILLED EXPLANATION ABOUT WHERE THE DATA COMES FROM AND IF IT IS REPRESENTATIVE OR NOT.

Our main interest is whether prices are higher in the inner than in the outer districts. We investigated the data on the collected prices and we have the following descriptive statistics on Snickers and Coke prices in inner and outer districts.

```{r, echo=FALSE}
P95 <- function(x){quantile(x,0.95,na.rm=T)}
P05 <- function(x){quantile(x,0.05,na.rm=T)}
Range <- function(x){max(x,na.rm=T)-min(x,na.rm=T)}


datasummary( (`Coke price` = p_coke )*(` ` = city) + (`Snickers price` = p_snickers )*(` ` = city)  ~
             Mean + Median + SD + Min + Max + Range + P05 + P95 + N , 
             data = df ,
             title = 'Descriptive statistics of Coke and Snickers prices' ) %>% 
  kableExtra::kable_styling(latex_options = "hold_position")
```


DESCRIPTION OF THE SUMMARY STATS: WHAT CAN WE LEARN FROM THEM?

As the focus is XXXX the next Figure shows the histogram XXXXX.

```{r, echo=FALSE, warning=FALSE, fig.width=3, fig.height = 3, fig.align="center" , fig.show="hold" , figures-side , out.width="50%" }

ggplot( df , aes( x = p_coke , group = city ) ) +
  geom_density( aes( y = ..density.. * 100  , fill = city ) , alpha = 0.3  ) +
  labs( title = 'Coke prices' , 
        subtitle = 'in the 14th and 7th districts' ,
        x = 'Price of Coke (500ml)' , 
        y = 'Relative Frequency (%)'
        ) +
  scale_fill_discrete( name = 'Districts:' ) + 
  xlim(0,400) + 
  theme_custom()

ggplot( df , aes( x = p_snickers , group = city ) ) +
  geom_density( aes( y = ..density.. * 100  , fill = city ) , alpha = 0.3  ) +
  labs( title = 'Snickers prices' , 
        subtitle = 'in the 14th and 7th districts' ,
        x = 'Price of Snickers' , 
        y = 'Relative Frequency (%)'
        ) +
  scale_fill_discrete( name = 'Districts:') + 
  xlim(0,400) + 
  theme_custom()

```

DESCRIPTION OF THE FIGURE. WHAT DOES IT TELS US?

(May change the order of descriptive stats and graph.)


## Conclusion

HERE COMES WHAT WE HAVE LEARNED AND WHAT WOULD STRENGHTEN AND WEAKEN OUR ANALYSIS.
